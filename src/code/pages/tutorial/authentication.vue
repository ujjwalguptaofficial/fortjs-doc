<template>
<Tutorial v-bind:innerHtml="tutorialContent" v-bind:pageTitle="title"></Tutorial>
</template>
<script lang="ts">
import { Component, Vue } from "nuxt-property-decorator";
import Tutorial from "../../components/tutorial.vue";
@Component({
  components: {
    Tutorial
  }
})
export default class extends Vue {
  tutorialContent = `%3Cp%3EThere%20are%20multiple%20ways%20in%20which%20we%20can%20authenticate.%20But%20we%20will%20learn%20how%20to%20do%20session%20authentication%20based%20on%20userid/password%20combination.%3C/p%3E%0A%3Cp%3ESo%20the%20concept%20is%20simple%20-%20a%20registered%20user%20has%20userid%20and%20password%20and%20they%20can%20access%20the%20system%20once%20they%20have%20entered%20valid%20credential.%20We%20need%20to%20design%20a%20login%20page%20through%20which%20user%20can%20login.%3C/p%3E%0A%3Cp%3Elet's%20consider%20that%20our%20app%20has%20a%20default%20controller%20and%20it%20can%20be%20accessed%20by%20anyone%20without%20login.%20Basically%20it%20contains%20a%20home%20page,%20a%20login%20page,%20a%20registration%20page%20etc.%3C/p%3E%0A%3Cpre%3E%3Ccode%3Eexport%20class%20DefaultController%20extends%20Controller%20%7B%0A%20%20%20%20@DefaultWorker()%0A%20%20%20%20async%20default()%20%7B%0A%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20result%20=%20await%20viewResult('controller:default,action:default');%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20result;%0A%20%20%20%20%20%20%20%20%7D%20catch%20(ex)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.log(ex);%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20handle%20exception%20and%20show%20user%20a%20good%20message.%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20result%20=%20await%20textResult(%60Our%20server%20is%20busy%20right%20now.%20Please%20try%20later.%60);%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20result;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20@Worker(%5BHTTP_METHOD.Get%5D)%0A%20%20%20%20@Route(%22/login%22)%0A%20%20%20%20async%20getloginForm()%20%7B%0A%20%20%20%20%20%20%20%20const%20result%20=%20viewResult(%22login_form%22);%0A%20%20%20%20%20%20%20%20return%20result;%0A%20%20%20%20%7D%20%0A%0A%20%20%20%20@Worker(%5BHTTP_METHOD.Post%5D)%0A%20%20%20%20async%20login()%20%7B%0A%20%20%20%20%20%20%20%20const%20emailId%20=%20this.body.emailId;%0A%20%20%20%20%20%20%20%20const%20pwd%20=%20this.body.password;%0A%20%20%20%20%20%20%20%20if%20(emailId%20!=%20null%20&amp;&amp;%20pwd%20!=%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20userService%20=%20new%20UserService();%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20user%20=%20userService.getUserByEmail(emailId);%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(user%20!=%20null%20&amp;&amp;%20user.password%20===%20pwd)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.session.set('userId',%20user.id);%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.session.set('emailId',%20emailId);%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20textResult(%60Authenticated%60);%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20result%20=%20textResult(%22Invalid%20credential%22);%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20result;%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20result%20=%20textResult(%22Please%20make%20sure,%20you%20are%20sending%20emailId%20and%20password%22);%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20result;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%3C/code%3E%3C/pre%3E%0A%3Cp%3EYou%20can%20see%20-%20we%20have%20three%20worker.%3C/p%3E%0A%3Cul%3E%0A%3Cli%3E%3Cstrong%3Edefault%3C/strong%3E%20-%20is%20used%20to%20show%20the%20home%20page%3C/li%3E%0A%3Cli%3E%3Cstrong%3EgetloginForm%3C/strong%3E%20-%20is%20used%20to%20show%20the%20login%20form%20when%20request%20is%20%22GET%22%3C/li%3E%0A%3Cli%3E%3Cstrong%3Elogin%3C/strong%3E%20-%20is%20%20used%20to%20login%20into%20the%20sytem%20through%20POST%20request.This%20method%20retrieve%20emailId%20and%20password%20from%20post%20and%20check%20whether%20emailId/password%20is%20correct.%20And%20if%20correct%20-%20it%20creates%20the%20session.%3C/li%3E%0A%3C/ul%3E%0A%3Cp%3EOnce%20the%20session%20has%20been%20set%20for%20a%20user.%20It%20can%20be%20accessed%20anywhere%20in%20the%20system%20(any%20controller/worker)%20using%20-%20%3Ccode%3Ethis.session.get('userId')%3C/code%3E%20%20or%20%3Ccode%3Ethis.session.isExist('userId')%3C/code%3E%3C/p%3E%0A%3Cp%3EIn%20order%20to%20not%20allow%20unauthenticated%20user%20to%20access%20restrcited%20method%20:%20we%20can%20check%20in%20every%20worker%20-%20If%20session%20is%20set%20or%20not%20and%20then%20based%20on%20that%20take%20actions.%3C/p%3E%0A%3Cp%3Ee.g%20-%20if%20session%20is%20present%20then%20fulfill%20the%20request%20otherwise%20redirect%20to%20login%20page%20or%20send%20a%20text%20response%20with%20http%20code%20401.%3C/p%3E%0A%3Cp%3EWe%20can%20take%20the%20above%20concept%20and%20divide%20into%20%3Ca%20href=%22/tutorial/wall%22%3Ecomponent%3C/a%3E.%20So%20that%20we%20dont%20need%20to%20write%20in%20every%20method.%20We%20can%20use%20shield%20or%20guard%20-%20this%20completely%20depends%20upon%20application.%3C/p%3E%0A%3Cp%3ELet's%20consider%20that%20we%20want%20to%20restrict%20at%20controller%20level%20and%20for%20this%20we%20need%20to%20create%20a%20%3Ca%20href=%22/tutorial/shield%22%3Eshield%3C/a%3E%20-%20%3C/p%3E%0A%3Cpre%3E%3Ccode%3Eimport%20%7B%0A%20%20%20%20Shield,%0A%20%20%20%20textResult,%0A%20%20%20%20redirectResult%0A%7D%20from%20%22fortjs%22;%0Aexport%20class%20AuthenticationShield%20extends%20Shield%20%7B%0A%20%20%20%20async%20protect()%20%7B%0A%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20isExist%20=%20await%20this.session.isExist('userId');%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(exist)%20%7B%20//%20user%20is%20authenticated%20so%20allow%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20null;%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%20//user%20is%20not%20authenticated,%20so%20not%20allow%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20redirectResult(%22/default/login%22);%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20catch%20(ex)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20log%20the%20error%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20return%20%20some%20good%20message%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20textResult(%22Our%20Server%20is%20busy%20right%20now,%20we%20are%20sorry%20for%20inconvenience.%20Please%20try%20later.%22)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%3C/code%3E%3C/pre%3E%0A%3Cp%3ENow%20we%20can%20add%20shield%20to%20any%20controllers%20where%20we%20need%20to%20restrict.%20Let's%20add%20this%20into%20user%20controller%20-%20%3C/p%3E%0A%3Cpre%3E%3Ccode%3Eimport%20%7B%0A%20%20%20%20Controller,%0A%20%20%20%20Shields%20%0A%7D%20from%20%22fortjs%22;%0Aimport%20%7B%0A%20%20%20%20AuthenticationShield%0A%7D%20from%20%22location%20where%20shield%20is%20defined%22;%0A%0A@Shields(%5BAuthenticationShield%5D)%20%0Aexport%20class%20UserController%20extends%20Controller%20%7B%0A%0A%7D%0A%3C/code%3E%3C/pre%3E%0A%3Cp%3EIn%20the%20similar%20way%20-%20you%20can%20create%20a%20%3Ca%20href=%22/tutorial/guard%22%3Eguard%3C/a%3E%20to%20restrict%20at%20worker%20level.%3C/p%3E`;
  title="Authentication";
}
</script>
